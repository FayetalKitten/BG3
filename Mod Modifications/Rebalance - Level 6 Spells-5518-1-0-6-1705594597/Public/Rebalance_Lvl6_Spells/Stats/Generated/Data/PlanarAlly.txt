new entry "Target_PlanarAlly_Cambion"
type "SpellData"
data "SpellType" "Target"
using "Target_PlanarAlly_Cambion"
data "Icon" "SYR_Spell_PlanarAlly_Cambion"
data "SpellProperties" "AI_IGNORE:Ground:Summon(5920d0f2-e892-42aa-89e8-0a4bc15332ab, -1,Projectile_AiHelper_Summon_Strong,,'PlanarAllyStack',UNSUMMON_ABLE,SHADOWCURSE_SUMMON_CHECK);AI_ONLY:Ground:Summon(5920d0f2-e892-42aa-89e8-0a4bc15332ab, -1,Projectile_AiHelper_Summon_Strong,,'PlanarAllyStack',UNSUMMON_ABLE,SHADOWCURSE_SUMMON_CHECK,KNOCKED_OUT_SUMMON_DISMISS)"
data "TargetConditions" "CanStand('5920d0f2-e892-42aa-89e8-0a4bc15332ab') and not Character() and not Self()"

new entry "SYR_Cambion_PlanarAlly"
type "Character"
using "Cambion_PlanarAlly"
data "Strength" "20"
data "Dexterity" "18"
data "Constitution" "18"
data "Intelligence" "12"
data "Wisdom" "14"
data "Charisma" "20"
data "Armor" "12"
data "Vitality" "98"
data "DefaultBoosts" "ProficiencyBonus(SavingThrow, Strength);ProficiencyBonus(SavingThrow, Dexterity);ProficiencyBonus(SavingThrow, Constitution);ProficiencyBonus(SavingThrow, Charisma);BlockRegainHP(Undead;Construct);ProficiencyBonusOverride(Owner.LevelMapValue(StandardProficiencyBonusScale));UnlockSpell(SYR_Target_FiendishCharm_Cambion);UnlockSpell(SYR_Target_DrainingKiss_Cambion);UnlockSpell(Projectile_FireRay_Cambion);UnlockSpell(Projectile_Fly);UnlockSpell(Target_Shove);UnlockSpell(Target_Dip);UnlockSpell(Projectile_Jump);RollBonus(Attack,max(Owner.StrengthModifier,Owner.DexterityModifier,Owner.IntelligenceModifier,Owner.WisdomModifier,Owner.CharismaModifier)-2)"
data "Passives" "ImmuneToDisarm;AttackOfOpportunity;DarknessRules;Darkvision;DispelEvilAndGood_Charm_Check;DispelEvilAndGood_Frightened_Check;DispelEvilAndGood_Possessed_Check;ShortResting;ExtraAttack;ExtraAttack_2;FiendishBlessing"

new entry "SYR_Glaive_Cambion_PlanarAlly"
type "Weapon"
using "WPN_Glaive"
data "RootTemplate" "45084d21-9288-4b52-80cd-175d1bd768a2"
data "BoostsOnEquipMainHand" "UnlockSpell(Rush_SpringAttack);UnlockSpell(Target_Slash_New);UnlockSpell(Shout_Steady)"
data "DefaultBoosts" "WeaponEnchantment(1);WeaponProperty(Magical);WeaponDamage(2d4, Fire)"

new entry "SYR_CAMBION_GLAIVE_DIPPED_FIRE"
type "StatusData"
data "StatusType" "BOOST"
using "MAG_FIRE_ALWAYS_DIPPED_FIRE"
data "Boosts" "IgnoreResistance(Fire,Resistant)"

new entry "SYR_Target_FiendishCharm_Cambion"
type "SpellData"
data "SpellType" "Target"
using "Target_FiendishCharm_Cambion"
data "SpellProperties" ""
data "SpellRoll" "not SavingThrow(Ability.Wisdom,SYR_SummonersBestDC(),AdvantageOnCharmed())"
data "SpellSuccess" "ApplyStatus(SYR_CHARMED_FIEND,100,3)"
data "TargetConditions" "not Self() and Character() and Tagged('HUMANOID') and not (not Player(context.Source) and IsCrowdControlled(context.Target))"
data "ExtraDescription" ""

new entry "SYR_Target_DrainingKiss_Cambion"
type "SpellData"
data "SpellType" "Target"
using "Target_DrainingKiss_Cambion"
data "SpellRoll" "not SavingThrow(Ability.Wisdom,SYR_SummonersBestDC())"
data "TargetConditions" "HasStatus('SG_Charmed') and not Dead() and not Self()"

new entry "SYR_CHARMED_FIEND"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf903fca5gebd7g4f4dgbdc7g1b59d7b669c5;1"
data "Description" "h2245f1a6gc069g4211g904cgfeb37e6ba1c7;1"
data "Icon" "Status_Charmed"
data "SoundLoop" "Spell_Status_Control_MO"
data "SoundStop" "Spell_Status_Control_MO_Stop"
data "StackId" "CHARMED"
data "Boosts" "CannotHarmCauseEntity(CannotHarmCharmer);Advantage(SourceDialogue,Charisma);AiArchetypeOverride(SYR_charmed_fiend,2);Disadvantage(AttackRoll);Disadvantage(SavingThrow,Intelligence);Disadvantage(SavingThrow,Wisdom);Disadvantage(SavingThrow,Charisma)"
data "RemoveConditions" "IsAttack() and HasDamageEffectFlag(DamageFlags.Hit) and not SpellId('Target_DrainingKiss_Cambion')"
data "RemoveEvents" "OnAttacked"
data "StatusGroups" "SG_Charmed;SG_Condition;SG_Charmed_Subtle"
data "StatusEffect" "a53689ae-d00b-45e1-8dd6-4540635f070e"


//Inheriting Spells
new entry "Target_ORI_Wyll_SummonCambion"
type "SpellData"
data "SpellType" "Target"
using "Target_ORI_Wyll_SummonCambion"
data "SpellContainerID" ""
data "Cooldown" "OncePerRestPerItem"
data "SpellProperties" "Ground:Summon(5920d0f2-e892-42aa-89e8-0a4bc15332ab, -1,Projectile_AiHelper_Summon_Strong,,'PlanarAllyStack',MAG_CAMBION_SUMMON,SHADOWCURSE_SUMMON_CHECK,KNOCKED_OUT_SUMMON_DISMISS,UNSUMMON_ABLE)"
data "UseCosts" "ActionPoint:1"

//Icons
new entry "Target_PlanarAlly_Deva"
type "SpellData"
data "SpellType" "Target"
using "Target_PlanarAlly_Deva"
data "Icon" "Spell_SightsOfTheSeelie_BestialCommunion_Summon"

new entry "Target_PlanarAlly_Djinni"
type "SpellData"
data "SpellType" "Target"
using "Target_PlanarAlly_Djinni"
data "Icon" "SYR_Spell_PlanarAlly_Djinni"


new entry "Djinni_PlanarAlly"
type "Character"
using "Djinni_PlanarAlly"
data "DefaultBoosts" "ProficiencyBonus(SavingThrow, Strength);ProficiencyBonus(SavingThrow, Constitution);ProficiencyBonus(SavingThrow, Charisma);BlockRegainHP(Undead;Construct);ProficiencyBonusOverride(Owner.LevelMapValue(StandardProficiencyBonusScale));RollBonus(Attack,max(Owner.StrengthModifier,Owner.DexterityModifier,Owner.IntelligenceModifier,Owner.WisdomModifier,Owner.CharismaModifier)-2)"

new entry "Zone_Thunderwave_Djinni"
type "SpellData"
data "SpellType" "Zone"
using "Zone_Thunderwave_Djinni"
data "SpellRoll" "not SavingThrow(Ability.Constitution, SYR_SummonersBestDC())"

new entry "Zone_Inhale_Djinni"
type "SpellData"
data "SpellType" "Zone"
using "Zone_Inhale_Djinni"
data "SpellRoll" "not SavingThrow(Ability.Constitution, SYR_SummonersBestDC())"

new entry "WHIRLWIND_CHECK"
type "StatusData"
data "StatusType" "BOOST"
using "WHIRLWIND_CHECK"
data "OnApplyRoll" "not SavingThrow(Ability.Strength, SYR_SummonersBestDCTopLevel())"
data "OnTickRoll" "not SavingThrow(Ability.Strength, SYR_SummonersBestDCTopLevel())"

new entry "Deva_PlanarAlly"
type "Character"
using "Deva_PlanarAlly"
data "DefaultBoosts" "ProficiencyBonus(SavingThrow,Wisdom);ProficiencyBonus(SavingThrow,Charisma);DialogueBlock();BlockRegainHP(Undead;Construct);ProficiencyBonusOverride(Owner.LevelMapValue(StandardProficiencyBonusScale));RollBonus(Attack,max(Owner.StrengthModifier,Owner.DexterityModifier,Owner.IntelligenceModifier,Owner.WisdomModifier,Owner.CharismaModifier)-2);UnlockSpell(Target_Shove);UnlockSpell(Target_Dip);UnlockSpell(Projectile_Jump)"

new entry "Target_Wrathful_Smite_Deva"
type "SpellData"
data "SpellType" "Target"
using "Target_Wrathful_Smite_Deva"
data "SpellSuccess" "DealDamage(MainMeleeWeapon,MainMeleeWeaponDamageType);ExecuteWeaponFunctors(MainHand);ApplyStatus(FRIGHTENED,100,2,,,,not SavingThrow(Ability.Wisdom, SYR_SummonersBestDC(), AdvantageOnFrightened(), DisadvantageOnFrightened()));DealDamage(1d6,Psychic,Magical)"