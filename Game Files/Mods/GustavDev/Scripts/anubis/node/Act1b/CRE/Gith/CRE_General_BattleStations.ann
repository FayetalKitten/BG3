game.states.CRE_General_BattleStations = State 
{
    function()
    description = [[Behaviour for all the gith in the Creche to stand at their battlestations.]]
    modules = {"shared.dialog", "shared.util", "shared.moveto" }

    ------------------------------------------------
    -- Params


    ------------------------------------------------

    ------------------------------------------------
    -- Local State variables

    local battlePos = "S_CRE_BattleStations_DummyPos_8d334cfc-e668-4913-b0ab-7077d597c181"
    ------------------------------------------------ 

    ------------------------------------------------
    -- Helper functions
    ------------------------------------------------
 
    ------------------------------------------------
    -- State (self) node functions
    ------------------------------------------------
    
    ------------------------------------------------
    -- Nodes

    -- Action

    


    ------------------------------------------------
    -- Events   
    ------------------------------------------------
    nodes.StandAtTrigger = Action {
        function ()
        
            if mod.moveto.MoveToPoint(battlePos, MovementSpeed.Run, me, 0.5) then
                DebugText(me, "At BattleStation")
                LookFrom(battlePos)
            end

            Sleep(5.0)

        end,
        CanEnter = function()
            return battlePos~=nil
        end 
    }

    nodes.Action_FallBack = Action
    {
        function ()
            WaitForInterrupt()
        end,

        Valid = function()
            return battlePos==nil
        end
    }


    events.EntityEvent = function(e)
       if e.TargetEntity == me and e.Event == "CrecheBattlePosition" then
           battlePos = e.Params[1]
       end
    end
end
}

