game.states.EPI_Shadowheart = State{
    function ()
    
        modules = {"shared.dialog", "shared.moveto"}

        local ad_winesupply = Dialog("EPI_Epilogue_AD_Shadowheart_WineSupply_8e768306-fd25-70ab-f095-0d95663ba4a1")
        local ad_backgroundmention = Dialog("EPI_Epilogue_AD_IdleShadowheart_781a4aca-6806-58ae-4803-b9fd555cd700")
        local ad_woundflare = Dialog("EPI_Epilogue_AD_Shadowheart_WoundFlare_44db71ce-8f28-e418-1b8f-0b65f5b3b097")

        local trig_alonemood = Entity("S_EPI_SHMood_Alone_fcdafe9e-1434-431d-ab33-1b3b713e9a18")
        local trig_watermood = Entity("S_EPI_SHMood_Water_c3fb671e-b50d-446d-8357-c2d0e8b819ff")
        local trig_eatingmood = Entity ("S_EPI_SHMood_Eating_6884a231-752b-47bc-818f-72967957ca1e")
        local trig_dancingmood = Entity ("S_EPI_SHMood_Dancing_a3588b6b-2686-4b58-abc9-9fd3a45bdeb4")
        local trig_shadowheartpos = Entity("S_EPI_SHMood_Alone_fcdafe9e-1434-431d-ab33-1b3b713e9a18")
        local trig_bootpos = Entity("S_EPI_SHBootPoS_50d9445f-99ac-4aeb-8be2-d29fad91b988")
        local trig_warmhandspos = Entity("S_EPI_SHWarmHands_10ae3186-57a9-4546-b8ea-4094e2e2d1ff")
        local trig_owlbearpos = Entity("S_EPI_Shadowheart_PettingOwlbear_b9c658f5-11ae-44da-8b4b-44d388009b3f")
        local trig_drinkingpos = Entity("S_EPI_Shadowheart_Drinking_471737dc-a4da-4fc2-88fa-74fc994416c9")
        local trig_owlbearstartpos = Entity("S_EPI_SHOwlbear_4921f322-663c-4f11-a071-ac288e1ba76e")

        local flag_currentmood = Flag("EPI_Shadowheart_State_Mood_Alone_73be97f7-b1b4-4139-a0ef-45ed2ade44c4")
        local flag_alonemood = Flag("EPI_Shadowheart_State_Mood_Alone_73be97f7-b1b4-4139-a0ef-45ed2ade44c4")
        local flag_watermood = Flag("EPI_Shadowheart_State_Mood_Water_b8a1bfd3-96ac-4e14-8cad-ed5a744e1c76")
        local flag_eatingmood = Flag("EPI_Shadowheart_State_Mood_Eating_fe8e726d-934b-43dc-ae4c-2c4d56210ab5")
        local flag_dancingmood = Flag("EPI_Shadowheart_State_Mood_Dancing_00aa5252-883a-4312-9bd6-b498489a5614")
        local flag_unlockroaming = Flag("EPI_Shadowheart_UnlockRoaming_b034872b-2d5f-4ce5-9946-7448d70b960c")
        local flag_sharparents = Flag("ORI_Shadowheart_State_Shar_SavedParents_8a0fad17-1615-4a0d-a045-21661d9a2aa0")
        local flag_enemyparents = Flag("ORI_Shadowheart_State_RejectShar_SavedParents_486d69d4-a7c2-4cb5-8fcb-8f2cb738ada9")
        local flag_owlbearpresent = Flag("EPI_Epilogue_State_OwlbearPresent_c82fdbb9-6a15-4f06-95d2-7e4babf2a982")
        local flag_owlbearavailable = Flag("EPI_OwlbearCub_State_PettingAvailable_90327c1a-537f-4df1-b31f-d03a00d029ba")
        local flag_pettingavailable = Flag("EPI_Shadowheart_State_PettingAvailable_84d1c35c-662b-4468-a20d-b468653e3daf")
        local flag_beachoccupied = Flag("EPI_Origins_State_BeachOccupied_d915b645-b52f-41cc-ba61-76268aac41af")

        local int_dancing = 0
        local int_stargazing = 1
        local int_consuming = 0
        local int_coolfeet = 0
        local int_woundflare = 1
        local int_holdflower = 1
        local int_owlbeartend = 1
        local int_warminghands = 0
        local int_thinking = 1
        local int_dejected = 0
        local int_changemood = 1 
        local int_mood
        local int_moodcap = 20
        local int_addmood = 0
        local int_consume
        local int_flare
        local int_randomAD

        local bool_museddrink = false

        local obj_chair = Entity("S_EPI_Shadowheart_DrinkingChair_8fbd70c6-6c24-45a9-9322-40d3a05f9ccb")
        local obj_winegoblet = Entity("S_EPI_Shadowheart_WineGlass_719d69c7-f8b4-445b-a63e-24171feb977e")

        local pos_chair
        local pos_winegoblet

        local char_owlbear = Entity("S_FOR_OwlBear_Cub_001_c66b2865-6613-4372-b97a-e330c1d75d09")

        local isAnimating = false

        local dancingAnimLoop = Animation("CUST_EPI_Shadowheart_Dance_01_Loop_2a82690c-f334-4f0d-964f-0161f9efd9e6")
        local dancingAnimStart = Animation("CUST_EPI_Shadowheart_Dance_01_Start_9dc6faf8-95d3-45dc-bdde-5eb514a180c6")
        local dancingAnimEnd = Animation("CUST_EPI_Shadowheart_Dance_01_End_2a9a295a-6f54-481b-8c4d-79f59735d40b")

        local starGazingAnimLoop = Animation("CUST_EPI_Shadowheart_Stargazing_01_Loop_3d2ad8b1-f894-4ecb-ac07-de2c482e537a")
        local starGazingAnimStart = Animation("CUST_EPI_Shadowheart_Stargazing_01_Start_223fb421-5f87-47e8-bd8e-2c3a305f5c1a")
        local starGazingAnimEnd = Animation("CUST_EPI_Shadowheart_Stargazing_01_End_3edd1f43-5de9-40e4-850e-655e25ad9998")

        local testWaterAnimLoop = Animation("CUST_EPI_Shadowheart_TestingWaters_01_Loop_eacaabfe-307d-492b-8826-6581bb841bff")
        local testWaterAnimStart = Animation("CUST_EPI_Shadowheart_TestingWaters_01_Start_a9c27369-481a-4e45-9ab3-a5fbd42334d5")
        local testWaterAnimEnd = Animation("CUST_EPI_Shadowheart_TestingWaters_01_End_f6933fb2-46c9-40cf-8cce-08e9cc58ba62")

        local flowerLookingAnimLoop = Animation("CUST_EPI_Shadowheart_LookingAtFlower_01_Loop_a481a91e-d3f1-4247-bbbd-6c33d39eff15")
        local flowerLookingAnimStart = Animation("CUST_EPI_Shadowheart_LookingAtFlower_01_Start_923079df-b2c4-4741-b5fc-665a8d144665")
        local flowerLookingAnimEnd = Animation("CUST_EPI_Shadowheart_LookingAtFlower_01_End_51964b27-d112-4ab5-88da-a22e273a9b6f")

        local warminghandsAnimLoop = Animation("CUST_WarmingByFire_01_Loop_e2d0b8f4-00ae-49a4-a878-a9841fd78a96")
        local warminghandsAnimStart = Animation("CUST_WarmingByFire_01_Start_901742e2-f648-42cb-bfa1-4b5e55e58479")
        local warminghandsAnimEnd = Animation("CUST_WarmingByFire_01_End_bcbfc7ca-11b4-44ad-b73e-f3d4862e86c5")

        local thinkingAnimLoop = Animation("CUST_Pondering_01_Loop_a47454a1-05a2-4153-bdfe-7a0500fa62d0")
        local thinkingAnimStart = Animation("CUST_Pondering_01_Start_2d14e6a9-d3a3-4f98-9031-22831546c392")
        local thinkingAnimEnd = Animation("CUST_Pondering_01_End_e15cc480-7f1a-4ed4-8a3c-36355a37c644")

        local dejectedAnimLoop = Animation("CUST_Dejected_01_Loop_487b6cb3-1ca3-4041-acba-bcac93cfcbe5")
        local dejectedAnimStart = Animation("CUST_Dejected_01_Start_55dac046-b8d2-4681-906d-f263c263071c")
        local dejectedAnimEnd = Animation("CUST_Dejected_01_End_c49344c6-72ce-460a-b55c-94708983e6be")

        local eatingAnimLoop = Animation("CUST_EPI_Shadowheart_Eating_01_b8eeb9da-8c8c-4727-8af9-46852860f988")

        local woundFlareAnim = Animation("CUST_EPI_Shadowheart_WoundFlaring_01_1e154f3b-825a-4a19-8200-e777bb87388f")

        local equip_shadowheartboots = nil

        local dialog_owlbear = Dialog("BHVR_WRLD_EPI_Shadowheart_PettingOwlbear_b5eddce1-0576-060a-1222-7ea9574b3486")
        local dialog_winedrinking = Dialog("BHVR_WRLD_EPI_Shadowheart_SitAndDrink_2c3f46cb-765d-c9b5-7c4d-dc5a9075e60d")

        self.OnInit = function()
            pos_chair = (obj_chair.Position)
            pos_winegoblet = (obj_winegoblet.Position)
        end

         --------------------------HELPER SECTION--------------------------

        helpers.action.RemoveBoots = function()
            if equip_shadowheartboots == nil then 
                equip_shadowheartboots = GetEquippedItem(me.Character, EquipmentSlot.VanityBoots)
            end

            if equip_shadowheartboots ~= nil and GetEquippedItem(me.Character, EquipmentSlot.VanityBoots) ~= nil then
                DebugText(me, "Remove Boots")
                helpers.ShadowheartMoveTo(trig_bootpos)
                Unequip(me.Character, equip_shadowheartboots.Item)
                DropItem(equip_shadowheartboots)
                DebugText(me, "Drop Boots")
                end
                Sleep(1)
        end

        helpers.action.ShadowheartMoveTo = function(pos)
            if mod.moveto.MoveToPoint(pos, MovementSpeed.Stroll, me) then
                LookFrom(pos)
                Sleep(1.0)
            else
                LookFrom(pos)
            end
        end

        helpers.action.ShadowheartAD = function(ad)
            if mod.dialog.IsSpeakerAvailable(me) then
                StartAutomatedDialog(ad, true, me)
            end
        end

        helpers.action.AdjustMood = function(x, y)
            int_changemood = (int_changemood + x)  
            int_addmood = (int_addmood + y)
        end

        helpers.action.StopAnimation = function()
            if isAnimating then
                isAnimating = false
                StopAnimation(me)
                Sleep(5.0)
            end
        end

        --------------------------BEHAVIOR SECTION--------------------------

        nodes.Partying = Selector{
            function(nodes)
                return GetWeightedCanEnter(nodes, {
                    [nodes.Dancing] = int_dancing,
                    [nodes.Stargazing] = int_stargazing,
                    [nodes.Consuming] = int_consuming,
                    [nodes.CoolFeet] = int_coolfeet,
                    [nodes.WoundFlare] = int_woundflare,
                    [nodes.HoldFlower] = int_holdflower,
                    [nodes.OwlbearTend] = int_owlbeartend,
                    [nodes.WarmingHands] = int_warminghands,
                    [nodes.Thinking] = int_thinking,
                    [nodes.Dejected] = int_dejected,
                    [nodes.ChangeMood] = int_changemood
                })
            end
        }

        nodes.Partying.Dancing = Action {
            function()
            helpers.ShadowheartMoveTo(trig_shadowheartpos)
                if not isAnimating then
                    DebugText(me, "Animation: Dancing")
                    PlayLoopingAnimation(dancingAnimStart, {dancingAnimLoop}, dancingAnimEnd, false)
                    helpers.AdjustMood(2, -5)
                    isAnimating = true
                end
                Sleep(math.random(50.0, 60.0))
                StopAnimation(me)
                isAnimating = false   
                Sleep(5.0)
            end,
            CanEnter = function()
                return int_changemood < 5
               
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()          
            end
        }

        nodes.Partying.Stargazing = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                    if not isAnimating then
                        DebugText(me, "Animation: Stargazing")
                        PlayLoopingAnimation(starGazingAnimStart, {starGazingAnimLoop}, starGazingAnimEnd, false)
                        helpers.AdjustMood(2, 2)
                        isAnimating = true
                        int_randomAD = (math.random (3, 3))
                        if int_randomAD == 1 then
                            helpers.ShadowheartAD(ad_backgroundmention)
                        end
                    end
                    Sleep(math.random(39.0, 50.0))
                    StopAnimation(me)
                    isAnimating = false
                    Sleep(5.0)
            end,
            CanEnter = function()
                return int_changemood < 5 and int_coolfeet ~= 1
                   
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }

        nodes.Partying.Consuming = Action {
            function()
                    int_consume = math.random (1, 3)
                    if int_consume == 1 or (obj_chair.Position ~= pos_chair) or (obj_winegoblet.Position ~= pos_winegoblet) then
                        helpers.ShadowheartMoveTo(trig_shadowheartpos)
                        DebugText(me, "Animation: Eating")
                        helpers.AdjustMood(1, -1)
                        PlayAnimation(eatingAnimLoop, true, false)
                    elseif int_consume > 1 then
                        if (obj_chair.Position == pos_chair) and (obj_winegoblet.Position == pos_winegoblet) then
                            helpers.ShadowheartMoveTo(trig_drinkingpos)
                            try
                                UseItem(obj_chair.Item)
                                helpers.AdjustMood(1, 2)
                                try
                                    StartBehaviorDialog(dialog_winedrinking, trig_drinkingpos.Trigger, false, me, obj_chair, obj_winegoblet)
                                    DebugText(me, "Animation: Drinking")
                                    Sleep(math.random(50.0, 70.0))
                                    BehaviorDialogRequestGracefulStop(me, false, nil)
                                catch e if ls.CheckType(e, error.BehaviorDialogStartFailed) then
                                    DebugText(me, "Error: Drinking Dialog not working yet")
                                    Sleep(3.0)
                                end
                            catch e if ls.CheckType(e, error.UseItemFailed) then
                                Sleep(3.0)
                            end
                        end
                    end
                    Sleep(6.0)
            end,
            CanEnter = function()
                return GetFlag(flag_owlbearpresent) and GetFlag(flag_owlbearavailable) and int_changemood < 5
    
            end
        }

        nodes.Partying.CoolFeet = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                    if not isAnimating then
                        DebugText(me, "Animation: Testing Water")
                        helpers.AdjustMood(2, -5)
                        PlayLoopingAnimation(testWaterAnimStart, {testWaterAnimLoop}, testWaterAnimEnd, false)
                        isAnimating = true
                    end
                    Sleep(math.random(10.0, 15.0))
                    StopAnimation(me)
                    isAnimating = false   
                    Sleep(5.0)
                    int_stargazing = 1
                    int_coolfeet = 0
                    int_holdflower = 1
                    int_thinking = 1
            end,
            CanEnter = function()
                return int_changemood < 5
                   
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }

        nodes.Partying.WoundFlare = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                DebugText(me, "Animation: Wound Flare")
                ApplyStatus(me, "ORI_WOUND_FLARE", true, 6.0)
                PlayAnimation(woundFlareAnim, true, false)
                int_dejected = 1
                int_woundflare = 0
                helpers.AdjustMood(3, 10)
                helpers.ShadowheartAD(ad_woundflare)
                Sleep(6.0)
            end,
            CanEnter = function()
                return int_changemood < 5
               
            end,
            CanEnter = function()
                int_flare = (math.random (1, 4))
                return GetFlag(flag_sharparents) or GetFlag(flag_enemyparents) and (int_flare == 1)
            end
        }

        nodes.Partying.HoldFlower = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                    if not isAnimating then
                        DebugText(me, "Animation: Holding Flower")
                        helpers.AdjustMood(2, 10)
                        PlayLoopingAnimation(flowerLookingAnimStart, {flowerLookingAnimLoop}, flowerLookingAnimEnd, false)
                        int_holdflower = 0
                        isAnimating = true
                        int_randomAD = (math.random (3, 3))
                        if int_randomAD == 1 then
                            helpers.ShadowheartAD(ad_backgroundmention)
                        end
                    end
                    Sleep(math.random(10.0, 15.0))
                    StopAnimation(me)
                    isAnimating = false  
                    Sleep(5.0)
            end,
            CanEnter = function()
                return int_changemood < 5
                   
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }

        nodes.Partying.WarmingHands = Action {
            function()
                helpers.ShadowheartMoveTo(trig_warmhandspos)
                    if not isAnimating then
                        DebugText(me, "Animation: Warming Hands")
                        helpers.AdjustMood(3, -1)
                        PlayLoopingAnimation(warminghandsAnimStart, {warminghandsAnimLoop}, warminghandsAnimEnd, false)
                        int_warminghands = 0
                        isAnimating = true
                        int_randomAD = (math.random (1, 3))
                        if int_randomAD == 1 then
                            helpers.ShadowheartAD(ad_backgroundmention)
                        end
                    end
                    Sleep(math.random(10.0, 15.0))
                    StopAnimation(me)
                    isAnimating = false  
                    Sleep(5.0)
            end,
            CanEnter = function()
                return int_changemood < 5
                   
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()  
            end
        }

        nodes.Partying.Thinking = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                    if not isAnimating then
                        DebugText(me, "Animation: Thinking")
                        helpers.AdjustMood(1, -1)
                        PlayLoopingAnimation(thinkingAnimStart, {thinkingAnimLoop}, thinkingAnimEnd, false)
                        isAnimating = true
                        if GetFlag(flag_eatingmood) and not bool_museddrink then
                            helpers.ShadowheartAD(ad_winesupply)
                            bool_museddrink = true
                        end
                    end
                    Sleep(math.random(10.0, 15.0))
                    StopAnimation(me)
                    isAnimating = false  
                    Sleep(5.0)      
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }


        nodes.Partying.Dejected = Action {
            function()
                helpers.ShadowheartMoveTo(trig_shadowheartpos)
                    if not isAnimating then
                        DebugText(me, "Animation: Dejected")
                        helpers.AdjustMood(2, -1) 
                        PlayLoopingAnimation(dejectedAnimStart, {dejectedAnimLoop}, dejectedAnimEnd, false)
                        isAnimating = true
                    end
                    Sleep(math.random(45.0, 55.0))
                    StopAnimation(me)
                    isAnimating = false  
                    Sleep(5.0)   
            end,
            CanEnter = function()
                return int_changemood < 5
           
            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }

        nodes.Partying.OwlbearTend = Action {
            function()
                helpers.ShadowheartMoveTo(trig_owlbearstartpos)
                SetFlag(flag_pettingavailable)
                try
                    StartBehaviorDialog(dialog_owlbear, trig_owlbearpos.Trigger, true, me, char_owlbear)
                    helpers.AdjustMood(1, 0)
                    DebugText(me, "Animation: Tending to Owlbear")
                    int_owlbeartend = 0
                    BehaviorDialogRequestGracefulStop(me, false, nil)
                catch e if ls.CheckType(e, error.BehaviorDialogStartFailed) then
                    DebugText(me, "Error: Owlbear Dialog not working yet")
                    Sleep(3.0)
                end

                int_flare = (math.random (1, 4))
                if GetFlag(flag_sharparents) or GetFlag(flag_enemyparents) and (int_flare == 1)then
                    Sleep(0.5)
                    DebugText(me, "Animation: Wound Flare")
                    helpers.AdjustMood(1, -20)
                    int_dejected = 1
                    int_woundflare = 0
                    ApplyStatus(me, "ORI_WOUND_FLARE", true, 6.0)
                    PlayAnimation(woundFlareAnim, true, false)
                    helpers.ShadowheartAD(ad_woundflare)
                else
                    helpers.AdjustMood(1, 10)
                end
                Sleep(6.0)
            end,
            CanEnter = function()
                return GetFlag(flag_owlbearpresent) and GetFlag(flag_owlbearavailable) and int_changemood < 5

            end,
            OnLeave = function()
            int_owlbeartend = 0
                if GetFlag (flag_pettingavailable) then
                    ClearFlag(flag_pettingavailable)
                end

            end,
            Valid = function()
                return GetFlag(flag_owlbearavailable)
            end
        }

        nodes.Partying.ChangeMood = Action {
            function()
                if GetFlag(flag_beachoccupied) and GetFlag(flag_watermood) then
                    ClearFlag(flag_beachoccupied)
                end
                
                int_mood = (math.random (1, int_moodcap) + int_addmood)
                ClearFlag(flag_currentmood)
                int_changemood = 0
                if int_mood < 0 then
                    int_mood = 0
                end

                if int_mood > int_moodcap then 
                    int_mood = int_moodcap
                end

                if int_mood < 11 and not GetFlag(flag_beachoccupied) then
                    DebugText(me, "Mood: Water")
                    SetFlag(flag_beachoccupied)
                    SetFlag(flag_watermood)
                    flag_currentmood = flag_watermood
                    helpers.RemoveBoots()

                elseif int_mood < 21 and int_mood > 10 or int_mood < 11 and GetFlag(flag_beachoccupied)then
                    DebugText(me, "Mood: Alone")
                    SetFlag(flag_alonemood)
                    flag_currentmood = flag_alonemood

                elseif int_mood < 36 and int_mood > 20 then
                    DebugText(me, "Mood: Eating")
                    SetFlag(flag_eatingmood)
                    flag_currentmood = flag_eatingmood

                elseif int_mood > 35 then
                    DebugText(me, "Mood: Dancing")
                    SetFlag(flag_dancingmood)
                    flag_currentmood = flag_dancingmood

                end
            end,
            OnLeave = function()
                StartTimer(me, "EPI_Shadowheart_MoodChanged", 20.0, 0)

            end,
        
            OnInterrupt = function()
                helpers.StopAnimation()
            end
        }


    --------------------------EVENT SECTION--------------------------

        events.TimerFinished = function(e)
            if e.TimerName == "EPI_Shadowheart_MoodChanged" then
                int_changemood = 1
            end
        end

        events.FlagSet = function(e)
            if (e.Flag == flag_alonemood) then
                int_dancing = 0
                int_stargazing = 1
                int_consuming = 0
                int_coolfeet = 0
                int_woundflare = 1
                int_holdflower = 1
                int_owlbeartend = 1
                int_warminghands = 0
                int_thinking = 1
                int_dejected = 0
                trig_shadowheartpos = trig_alonemood
                int_addmood = 5
                bool_museddrink = false

                if GetFlag(flag_unlockroaming) then
                    int_addmood = 5
                else
                    int_addmood = -15
                end


            elseif (e.Flag == flag_watermood.Guid) then
                int_dancing = 0
                int_stargazing = 1
                int_consuming = 0
                int_coolfeet = 1
                int_woundflare = 0
                int_holdflower = 0
                int_owlbeartend = 0
                int_warminghands = 0
                int_thinking = 0
                int_dejected = 0
                trig_shadowheartpos = trig_watermood
                int_addmood = 10
                bool_museddrink = false

            elseif (e.Flag == flag_eatingmood.Guid) then
                int_dancing = 0
                int_stargazing = 0
                int_consuming = 2
                int_coolfeet = 0
                int_woundflare = 1
                int_holdflower = 0
                int_owlbeartend = 0
                int_warminghands = 0
                int_thinking = 1
                int_dejected = -5
                trig_shadowheartpos = trig_eatingmood
                int_addmood = 0
                bool_museddrink = false

            elseif (e.Flag == flag_dancingmood.Guid) then
                int_dancing = 1
                int_stargazing = 0
                int_consuming = 0
                int_coolfeet = 0
                int_woundflare = 1
                int_holdflower = 0
                int_owlbeartend = 1
                int_warminghands = 1
                int_thinking = 0
                int_dejected = 0
                trig_shadowheartpos = trig_dancingmood
                int_addmood = -5
                bool_museddrink = flag_sharparents

            end
            
            if (e.Flag == flag_unlockroaming.Guid) then
                int_moodcap = 40
                int_addmood = (int_addmood + 5)
            end
        end


    end
}